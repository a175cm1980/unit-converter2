<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>綜合計算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f3f4f6;
            padding: 1rem;
        }
        .active-btn {
            background-color: #2563eb;
            color: white;
            border-color: #1d4ed8;
        }
        .input-group {
            display: none; /* Hide all input groups by default */
        }
        .input-group.active {
            display: block; /* Show the active input group */
        }
        canvas {
            border: 1px solid #e2e8f0;
            background-color: #ffffff;
            border-radius: 8px;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md space-y-6 transform transition-all duration-300 hover:shadow-xl">
        <h1 class="text-3xl font-bold text-center text-gray-800">綜合計算器</h1>
        <p class="text-center text-gray-600">請選擇您要計算的項目，並輸入對應的數值。</p>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700">選擇要計算的項目</label>
                <div class="mt-1 flex flex-wrap justify-center gap-2">
                    <button id="calc-power-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">功率 (P)</button>
                    <button id="calc-voltage-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">電壓 (V)</button>
                    <button id="calc-current-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">電流 (I)</button>
                    <button id="calc-torque-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">扭矩 (Nm)</button>
                    <button id="calc-trig-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">三角函數</button>
                    <button id="calc-area-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">面積計算</button>
                    <button id="calc-hyp-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">直角三角形斜邊 (c)</button>
                    <button id="calc-non-right-tri-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">非直角三角形斜邊</button>
                    <button id="calc-arc-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">弧長計算</button>
                    <button id="calc-line-speed-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">線速度</button>
                    <button id="calc-inverter-hz-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">變頻器HZ</button>
                </div>
            </div>

            <!-- Input groups, initially hidden -->
            <div id="input-power" class="input-group">
                <label for="power-input" class="block text-sm font-medium text-gray-700">功率 (P)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="power-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="瓦特">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">W</span>
                    </div>
                </div>
            </div>

            <div id="input-voltage" class="input-group">
                <label for="voltage-input" class="block text-sm font-medium text-gray-700">電壓 (V)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="voltage-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="伏特">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">V</span>
                    </div>
                </div>
            </div>
            
            <div id="input-current" class="input-group">
                <label for="current-input" class="block text-sm font-medium text-gray-700">電流 (I)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="current-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="安培">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">A</span>
                    </div>
                </div>
            </div>

            <div id="input-rpm" class="input-group">
                <label for="rpm-input" class="block text-sm font-medium text-gray-700">轉速 (RPM)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="rpm-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="每分鐘轉數">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">RPM</span>
                    </div>
                </div>
            </div>

            <div id="input-trig" class="input-group">
                <label for="angle-input" class="block text-sm font-medium text-gray-700">角度</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="angle-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="度數">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">°</span>
                    </div>
                </div>
                <div class="mt-4 flex justify-around space-x-2">
                    <button id="calc-sin-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">sin</button>
                    <button id="calc-cos-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">cos</button>
                    <button id="calc-tan-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">tan</button>
                </div>
            </div>

            <div id="input-area" class="input-group">
                <div class="flex flex-wrap justify-center gap-2 mt-4">
                    <button id="calc-rect-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">矩形</button>
                    <button id="calc-tri-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">三角形</button>
                    <button id="calc-trap-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">梯形</button>
                    <button id="calc-rhombus-btn" class="flex-1 py-2 px-4 rounded-md font-medium transition duration-150 ease-in-out text-sm border-2 border-transparent bg-gray-200 text-gray-700">菱形</button>
                </div>
                <div id="input-rect" class="mt-4">
                    <label for="rect-length-input" class="block text-sm font-medium text-gray-700">長度</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="rect-length-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="長度">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                    <label for="rect-width-input" class="block text-sm font-medium text-gray-700 mt-4">寬度</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="rect-width-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="寬度">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                </div>
                <div id="input-tri" class="mt-4 hidden">
                    <label for="tri-base-input" class="block text-sm font-medium text-gray-700">底</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="tri-base-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="底">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                    <label for="tri-height-input" class="block text-sm font-medium text-gray-700 mt-4">高</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="tri-height-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="高">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                </div>
                <div id="input-trap" class="mt-4 hidden">
                    <label for="trap-base1-input" class="block text-sm font-medium text-gray-700">上底</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="trap-base1-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="上底">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                    <label for="trap-base2-input" class="block text-sm font-medium text-gray-700 mt-4">下底</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="trap-base2-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="下底">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                    <label for="trap-height-input" class="block text-sm font-medium text-gray-700 mt-4">高</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="trap-height-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="高">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                </div>
                <div id="input-rhombus" class="mt-4 hidden">
                    <label for="rhombus-diag1-input" class="block text-sm font-medium text-gray-700">對角線 1</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="rhombus-diag1-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="對角線 1">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                    <label for="rhombus-diag2-input" class="block text-sm font-medium text-gray-700 mt-4">對角線 2</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <input type="number" id="rhombus-diag2-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="對角線 2">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">mm</span>
                        </div>
                    </div>
                </div>
                <canvas id="area-canvas" class="w-full h-auto max-h-56"></canvas>
            </div>

            <div id="input-hyp" class="input-group">
                <label for="hyp-a-input" class="block text-sm font-medium text-gray-700">直角邊 a (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="hyp-a-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="邊長 a">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="hyp-b-input" class="block text-sm font-medium text-gray-700 mt-4">直角邊 b (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="hyp-b-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="邊長 b">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <canvas id="hyp-canvas" class="w-full h-auto max-h-56"></canvas>
            </div>

            <!-- Non-right triangle hypotenuse calculation input group -->
            <div id="input-non-right-tri" class="input-group">
                <label for="non-right-a-input" class="block text-sm font-medium text-gray-700">邊長 a (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="non-right-a-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="邊長 a">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="non-right-b-input" class="block text-sm font-medium text-gray-700 mt-4">邊長 b (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="non-right-b-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="邊長 b">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="non-right-angle-input" class="block text-sm font-medium text-gray-700 mt-4">夾角 &theta; (度)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="non-right-angle-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="角度">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">°</span>
                    </div>
                </div>
                <canvas id="non-right-tri-canvas" class="w-full h-auto max-h-56"></canvas>
            </div>

            <div id="input-arc" class="input-group">
                <label for="radius-input" class="block text-sm font-medium text-gray-700">半徑 (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="radius-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="半徑">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="arc-angle-input" class="block text-sm font-medium text-gray-700 mt-4">角度 (度)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="arc-angle-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="度數">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">°</span>
                    </div>
                </div>
                <canvas id="arc-canvas" class="w-full h-auto max-h-56"></canvas>
            </div>

            <!-- Line speed input group -->
            <div id="input-line-speed" class="input-group">
                <label for="circumference-input" class="block text-sm font-medium text-gray-700">作業長度 (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="circumference-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="長度">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="line-speed-rpm-input" class="block text-sm font-medium text-gray-700 mt-4">作業速度 (RPM)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="line-speed-rpm-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="每分鐘轉數">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">RPM</span>
                    </div>
                </div>
            </div>

            <!-- Inverter HZ calculation input group -->
            <div id="input-inverter-hz" class="input-group">
                <label for="max-hz-input" class="block text-sm font-medium text-gray-700">最高頻率 (HZ)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="max-hz-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="最高頻率">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">HZ</span>
                    </div>
                </div>
                <label for="wheel-circumference-input" class="block text-sm font-medium text-gray-700 mt-4">作業輪圓周 (mm)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="wheel-circumference-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="作業輪圓周">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm</span>
                    </div>
                </div>
                <label for="motor-rpm-input" class="block text-sm font-medium text-gray-700 mt-4">馬達轉速 (RPM)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="motor-rpm-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="馬達轉速">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">RPM</span>
                    </div>
                </div>
                <label for="working-speed-input" class="block text-sm font-medium text-gray-700 mt-4">作業速度 (mm/min)</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" id="working-speed-input" class="block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3" placeholder="作業速度">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">mm/min</span>
                    </div>
                </div>
            </div>
        </div>
        
        <button id="calculate-btn" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
            計算
        </button>
        
        <div id="result-message" class="mt-4 text-center text-xl font-bold text-gray-800"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all required elements
            const powerInput = document.getElementById('power-input');
            const voltageInput = document.getElementById('voltage-input');
            const currentInput = document.getElementById('current-input');
            const rpmInput = document.getElementById('rpm-input');
            const angleInput = document.getElementById('angle-input');
            const radiusInput = document.getElementById('radius-input');
            const arcAngleInput = document.getElementById('arc-angle-input');
            
            const rectLengthInput = document.getElementById('rect-length-input');
            const rectWidthInput = document.getElementById('rect-width-input');
            const triBaseInput = document.getElementById('tri-base-input');
            const triHeightInput = document.getElementById('tri-height-input');
            const trapBase1Input = document.getElementById('trap-base1-input');
            const trapBase2Input = document.getElementById('trap-base2-input');
            const trapHeightInput = document.getElementById('trap-height-input');
            const rhombusDiag1Input = document.getElementById('rhombus-diag1-input');
            const rhombusDiag2Input = document.getElementById('rhombus-diag2-input');

            const hypAInput = document.getElementById('hyp-a-input');
            const hypBInput = document.getElementById('hyp-b-input');

            // Non-right triangle inputs
            const nonRightAInput = document.getElementById('non-right-a-input');
            const nonRightBInput = document.getElementById('non-right-b-input');
            const nonRightAngleInput = document.getElementById('non-right-angle-input');

            // Line speed inputs
            const circumferenceInput = document.getElementById('circumference-input');
            const lineSpeedRpmInput = document.getElementById('line-speed-rpm-input');

            // Inverter HZ inputs
            const maxHzInput = document.getElementById('max-hz-input');
            const wheelCircumferenceInput = document.getElementById('wheel-circumference-input');
            const motorRpmInput = document.getElementById('motor-rpm-input');
            const workingSpeedInput = document.getElementById('working-speed-input');

            // Canvases
            const hypCanvas = document.getElementById('hyp-canvas');
            const hypCtx = hypCanvas.getContext('2d');
            const areaCanvas = document.getElementById('area-canvas');
            const areaCtx = areaCanvas.getContext('2d');
            const arcCanvas = document.getElementById('arc-canvas');
            const arcCtx = arcCanvas.getContext('2d');
            const nonRightTriCanvas = document.getElementById('non-right-tri-canvas');
            const nonRightTriCtx = nonRightTriCanvas.getContext('2d');

            const calculateBtn = document.getElementById('calculate-btn');
            const resultMessage = document.getElementById('result-message');
            
            // Get all buttons
            const calcPowerBtn = document.getElementById('calc-power-btn');
            const calcVoltageBtn = document.getElementById('calc-voltage-btn');
            const calcCurrentBtn = document.getElementById('calc-current-btn');
            const calcTorqueBtn = document.getElementById('calc-torque-btn');
            const calcTrigBtn = document.getElementById('calc-trig-btn');
            const calcAreaBtn = document.getElementById('calc-area-btn');
            const calcHypBtn = document.getElementById('calc-hyp-btn');
            const calcNonRightTriBtn = document.getElementById('calc-non-right-tri-btn');
            const calcArcBtn = document.getElementById('calc-arc-btn');
            const calcLineSpeedBtn = document.getElementById('calc-line-speed-btn');
            const calcInverterHzBtn = document.getElementById('calc-inverter-hz-btn');
            const calcButtons = [calcPowerBtn, calcVoltageBtn, calcCurrentBtn, calcTorqueBtn, calcTrigBtn, calcAreaBtn, calcHypBtn, calcNonRightTriBtn, calcArcBtn, calcLineSpeedBtn, calcInverterHzBtn];

            const calcSinBtn = document.getElementById('calc-sin-btn');
            const calcCosBtn = document.getElementById('calc-cos-btn');
            const calcTanBtn = document.getElementById('calc-tan-btn');
            const trigButtons = [calcSinBtn, calcCosBtn, calcTanBtn];

            const calcRectBtn = document.getElementById('calc-rect-btn');
            const calcTriBtn = document.getElementById('calc-tri-btn');
            const calcTrapBtn = document.getElementById('calc-trap-btn');
            const calcRhombusBtn = document.getElementById('calc-rhombus-btn');
            const areaButtons = [calcRectBtn, calcTriBtn, calcTrapBtn, calcRhombusBtn];

            // Get all input groups
            const inputGroups = document.querySelectorAll('.input-group');
            const inputPowerGroup = document.getElementById('input-power');
            const inputVoltageGroup = document.getElementById('input-voltage');
            const inputCurrentGroup = document.getElementById('input-current');
            const inputRpmGroup = document.getElementById('input-rpm');
            const inputTrigGroup = document.getElementById('input-trig');
            const inputAreaGroup = document.getElementById('input-area');
            const inputHypGroup = document.getElementById('input-hyp');
            const inputNonRightTriGroup = document.getElementById('input-non-right-tri');
            const inputArcGroup = document.getElementById('input-arc');
            const inputLineSpeedGroup = document.getElementById('input-line-speed');
            const inputInverterHzGroup = document.getElementById('input-inverter-hz');
            
            const inputRectGroup = document.getElementById('input-rect');
            const inputTriGroup = document.getElementById('input-tri');
            const inputTrapGroup = document.getElementById('input-trap');
            const inputRhombusGroup = document.getElementById('input-rhombus');
            
            let calculationType = 'power'; // Default calculation type
            let trigFunction = 'sin'; // Default trig function
            let areaType = 'rectangle'; // Default area type

            // Function to draw right triangle
            function drawHypTriangle() {
                const a = parseFloat(hypAInput.value) || 0;
                const b = parseFloat(hypBInput.value) || 0;
                
                const canvasSize = 200;
                const padding = 20;

                hypCanvas.width = canvasSize;
                hypCanvas.height = canvasSize;

                hypCtx.clearRect(0, 0, canvasSize, canvasSize);

                if (a <= 0 || b <= 0) {
                    return;
                }

                const maxDim = Math.max(a, b);
                const scale = (canvasSize - 2 * padding) / maxDim;

                const scaledA = a * scale;
                const scaledB = b * scale;

                hypCtx.beginPath();
                hypCtx.moveTo(padding, canvasSize - padding);
                hypCtx.lineTo(padding, canvasSize - padding - scaledA);
                hypCtx.lineTo(padding + scaledB, canvasSize - padding);
                hypCtx.closePath();
                hypCtx.strokeStyle = '#2563eb';
                hypCtx.lineWidth = 2;
                hypCtx.stroke();

                hypCtx.fillStyle = '#4b5563';
                hypCtx.fillRect(padding, canvasSize - padding - 15, 15, 15);

                hypCtx.fillStyle = '#1f2937';
                hypCtx.font = '14px Inter';
                
                hypCtx.fillText(`a = ${a} mm`, padding + 5, canvasSize - padding - scaledA / 2);
                hypCtx.fillText(`b = ${b} mm`, padding + scaledB / 2, canvasSize - padding - 5);
                
                const c = Math.sqrt(a * a + b * b);
                const midX = padding + scaledB / 2;
                const midY = canvasSize - padding - scaledA / 2;
                hypCtx.fillText(`c = ${c.toFixed(2)} mm`, midX + 10, midY + 10);
            }

            // Function to draw non-right triangle
            function drawNonRightTri() {
                const a = parseFloat(nonRightAInput.value) || 0;
                const b = parseFloat(nonRightBInput.value) || 0;
                const angle = parseFloat(nonRightAngleInput.value) || 0;

                const canvasSize = 200;
                const padding = 20;

                nonRightTriCanvas.width = canvasSize;
                nonRightTriCanvas.height = canvasSize;
                nonRightTriCtx.clearRect(0, 0, canvasSize, canvasSize);

                if (a <= 0 || b <= 0 || angle <= 0 || angle >= 180) {
                    return;
                }

                // Calculate the third side c using the Law of Cosines
                const angleRad = angle * Math.PI / 180;
                const c = Math.sqrt(a * a + b * b - 2 * a * b * Math.cos(angleRad));

                const maxDim = Math.max(a, b, c);
                const scale = (canvasSize - 2 * padding) / maxDim;

                const scaledA = a * scale;
                const scaledB = b * scale;
                
                // Draw the triangle
                nonRightTriCtx.beginPath();
                nonRightTriCtx.moveTo(padding, canvasSize - padding); // Vertex 1
                nonRightTriCtx.lineTo(padding + scaledB, canvasSize - padding); // Vertex 2
                
                // Calculate position of the third vertex
                const cX = padding + scaledA * Math.cos(angleRad);
                const cY = canvasSize - padding - scaledA * Math.sin(angleRad);
                nonRightTriCtx.lineTo(cX, cY); // Vertex 3
                nonRightTriCtx.closePath();
                nonRightTriCtx.strokeStyle = '#2563eb';
                nonRightTriCtx.lineWidth = 2;
                nonRightTriCtx.stroke();
                
                // Draw arc for the angle
                nonRightTriCtx.beginPath();
                nonRightTriCtx.arc(padding, canvasSize - padding, 20, 0, -angleRad, true);
                nonRightTriCtx.strokeStyle = '#60a5fa';
                nonRightTriCtx.lineWidth = 1;
                nonRightTriCtx.stroke();
                
                // Labels
                nonRightTriCtx.fillStyle = '#1f2937';
                nonRightTriCtx.font = '14px Inter';
                nonRightTriCtx.fillText(`b = ${b} mm`, padding + scaledB / 2, canvasSize - padding + 15);
                nonRightTriCtx.fillText(`a = ${a} mm`, (padding + cX) / 2 + 5, (canvasSize - padding + cY) / 2 + 5);
                nonRightTriCtx.fillText(`c = ${c.toFixed(2)} mm`, (padding + scaledB + cX) / 2, (canvasSize - padding + cY) / 2 + 5);
                nonRightTriCtx.fillText(`θ = ${angle}°`, padding + 10, canvasSize - padding - 15);
            }

            // Function to draw area shape
            function drawAreaShape() {
                const canvasSize = 200;
                const padding = 20;
                areaCanvas.width = canvasSize;
                areaCanvas.height = canvasSize;
                areaCtx.clearRect(0, 0, canvasSize, canvasSize);
                
                areaCtx.strokeStyle = '#2563eb';
                areaCtx.lineWidth = 2;
                areaCtx.fillStyle = '#eff6ff';

                if (areaType === 'rectangle') {
                    const length = parseFloat(rectLengthInput.value) || 0;
                    const width = parseFloat(rectWidthInput.value) || 0;
                    if (length <= 0 || width <= 0) return;
                    const maxDim = Math.max(length, width);
                    const scale = (canvasSize - 2 * padding) / maxDim;
                    const scaledLength = length * scale;
                    const scaledWidth = width * scale;
                    areaCtx.fillRect(padding, canvasSize - padding - scaledWidth, scaledLength, scaledWidth);
                    areaCtx.strokeRect(padding, canvasSize - padding - scaledWidth, scaledLength, scaledWidth);
                    
                    areaCtx.fillStyle = '#1f2937';
                    areaCtx.fillText(`長度 = ${length} mm`, padding + scaledLength / 2 - 40, canvasSize - padding - 5);
                    areaCtx.save();
                    areaCtx.translate(padding + 5, canvasSize - padding - scaledWidth / 2);
                    areaCtx.rotate(-Math.PI / 2);
                    areaCtx.fillText(`寬度 = ${width} mm`, -20, -10);
                    areaCtx.restore();

                } else if (areaType === 'triangle') {
                    const base = parseFloat(triBaseInput.value) || 0;
                    const height = parseFloat(triHeightInput.value) || 0;
                    if (base <= 0 || height <= 0) return;
                    const maxDim = Math.max(base, height);
                    const scale = (canvasSize - 2 * padding) / maxDim;
                    const scaledBase = base * scale;
                    const scaledHeight = height * scale;
                    areaCtx.beginPath();
                    areaCtx.moveTo(padding, canvasSize - padding);
                    areaCtx.lineTo(padding + scaledBase, canvasSize - padding);
                    areaCtx.lineTo(padding + scaledBase / 2, canvasSize - padding - scaledHeight);
                    areaCtx.closePath();
                    areaCtx.fill();
                    areaCtx.stroke();
                    
                    areaCtx.fillStyle = '#1f2937';
                    areaCtx.fillText(`底 = ${base} mm`, padding + scaledBase / 2 - 20, canvasSize - padding - 5);
                    areaCtx.fillText(`高 = ${height} mm`, padding + scaledBase / 2 - 20, canvasSize - padding - scaledHeight / 2 + 20);

                } else if (areaType === 'trapezoid') {
                    const base1 = parseFloat(trapBase1Input.value) || 0;
                    const base2 = parseFloat(trapBase2Input.value) || 0;
                    const height = parseFloat(trapHeightInput.value) || 0;
                    if (base1 <= 0 || base2 <= 0 || height <= 0) return;
                    const maxBase = Math.max(base1, base2);
                    const scale = (canvasSize - 2 * padding) / Math.max(maxBase, height);
                    const scaledBase1 = base1 * scale;
                    const scaledBase2 = base2 * scale;
                    const scaledHeight = height * scale;
                    const offset = (scaledBase2 - scaledBase1) / 2;

                    areaCtx.beginPath();
                    areaCtx.moveTo(padding + offset, canvasSize - padding - scaledHeight);
                    areaCtx.lineTo(padding + offset + scaledBase1, canvasSize - padding - scaledHeight);
                    areaCtx.lineTo(padding + scaledBase2, canvasSize - padding);
                    areaCtx.lineTo(padding, canvasSize - padding);
                    areaCtx.closePath();
                    areaCtx.fill();
                    areaCtx.stroke();
                    
                    areaCtx.fillStyle = '#1f2937';
                    areaCtx.fillText(`上底 = ${base1} mm`, padding + offset + scaledBase1 / 2 - 20, canvasSize - padding - scaledHeight - 5);
                    areaCtx.fillText(`下底 = ${base2} mm`, padding + scaledBase2 / 2 - 20, canvasSize - padding - 5);
                    areaCtx.fillText(`高 = ${height} mm`, padding + scaledBase2 /2- 15, canvasSize - padding - scaledHeight / 2);
                } else if (areaType === 'rhombus') {
                    const diag1 = parseFloat(rhombusDiag1Input.value) || 0;
                    const diag2 = parseFloat(rhombusDiag2Input.value) || 0;
                    if (diag1 <= 0 || diag2 <= 0) return;
                    const maxDim = Math.max(diag1, diag2);
                    const scale = (canvasSize - 2 * padding) / maxDim;
                    const scaledDiag1 = diag1 * scale; 
                    const scaledDiag2 = diag2 * scale; 
                    const centerX = canvasSize / 2;
                    const centerY = canvasSize / 2;

                    areaCtx.beginPath();
                    areaCtx.moveTo(centerX, centerY - scaledDiag1 / 2);
                    areaCtx.lineTo(centerX + scaledDiag2 / 2, centerY);
                    areaCtx.lineTo(centerX, centerY + scaledDiag1 / 2);
                    areaCtx.lineTo(centerX - scaledDiag2 / 2, centerY);
                    areaCtx.closePath();
                    areaCtx.fill();
                    areaCtx.stroke();

                    areaCtx.strokeStyle = '#60a5fa';
                    areaCtx.setLineDash([5, 5]);
                    areaCtx.beginPath();
                    areaCtx.moveTo(centerX, centerY - scaledDiag1 / 2);
                    areaCtx.lineTo(centerX, centerY + scaledDiag1 / 2);
                    areaCtx.stroke();
                    areaCtx.beginPath();
                    areaCtx.moveTo(centerX - scaledDiag2 / 2, centerY);
                    areaCtx.lineTo(centerX + scaledDiag2 / 2, centerY);
                    areaCtx.stroke();
                    areaCtx.setLineDash([]);

                    areaCtx.fillStyle = '#1f2937';
                    areaCtx.fillText(`對角線1 = ${diag1} mm`, centerX + 5, centerY - scaledDiag1 / 4);
                    areaCtx.fillText(`對角線2 = ${diag2} mm`, centerX + scaledDiag2 / 4, centerY + 15);
                }
            }

            // Function to draw arc
            function drawArc() {
                const radius = parseFloat(radiusInput.value) || 0;
                const angle = parseFloat(arcAngleInput.value) || 0;

                const canvasSize = 200;
                const center = canvasSize / 2;
                arcCanvas.width = canvasSize;
                arcCanvas.height = canvasSize;
                arcCtx.clearRect(0, 0, canvasSize, canvasSize);

                if (radius <= 0 || angle <= 0) return;

                const scale = (canvasSize / 2 - 10) / radius;
                const scaledRadius = radius * scale;
                const startAngle = -Math.PI / 2;
                const endAngle = startAngle + (angle * Math.PI / 180);

                arcCtx.beginPath();
                arcCtx.arc(center, center, scaledRadius, startAngle, endAngle);
                arcCtx.strokeStyle = '#2563eb';
                arcCtx.lineWidth = 4;
                arcCtx.stroke();

                arcCtx.beginPath();
                arcCtx.moveTo(center, center);
                arcCtx.lineTo(center + scaledRadius * Math.cos(startAngle), center + scaledRadius * Math.sin(startAngle));
                arcCtx.moveTo(center, center);
                arcCtx.lineTo(center + scaledRadius * Math.cos(endAngle), center + scaledRadius * Math.sin(endAngle));
                arcCtx.strokeStyle = '#60a5fa';
                arcCtx.lineWidth = 1;
                arcCtx.stroke();

                arcCtx.fillStyle = '#1f2937';
                arcCtx.font = '14px Inter';
                arcCtx.fillText(`半徑 = ${radius} mm`, center + 10, center - 5);
                arcCtx.fillText(`角度 = ${angle}°`, center + 10, center + 15);
            }

            // Function to update button styles and input group visibility
            function updateState() {
                // Reset all main button styles
                calcButtons.forEach(btn => {
                    btn.classList.remove('active-btn');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                
                // Hide all input groups
                inputGroups.forEach(group => group.classList.remove('active'));

                // Clear all input values
                powerInput.value = '';
                voltageInput.value = '';
                currentInput.value = '';
                rpmInput.value = '';
                angleInput.value = '';
                radiusInput.value = '';
                arcAngleInput.value = '';
                rectLengthInput.value = '';
                rectWidthInput.value = '';
                triBaseInput.value = '';
                triHeightInput.value = '';
                trapBase1Input.value = '';
                trapBase2Input.value = '';
                trapHeightInput.value = '';
                rhombusDiag1Input.value = '';
                rhombusDiag2Input.value = '';
                hypAInput.value = '';
                hypBInput.value = '';
                nonRightAInput.value = '';
                nonRightBInput.value = '';
                nonRightAngleInput.value = '';
                circumferenceInput.value = '';
                lineSpeedRpmInput.value = '';
                maxHzInput.value = '';
                wheelCircumferenceInput.value = '';
                motorRpmInput.value = '';
                workingSpeedInput.value = '';
                
                // Clear all canvases
                hypCtx.clearRect(0, 0, hypCanvas.width, hypCanvas.height);
                areaCtx.clearRect(0, 0, areaCanvas.width, areaCanvas.height);
                arcCtx.clearRect(0, 0, arcCanvas.width, arcCanvas.height);
                nonRightTriCtx.clearRect(0, 0, nonRightTriCanvas.width, nonRightTriCanvas.height);

                // Show corresponding input group and update button style
                switch (calculationType) {
                    case 'power':
                        calcPowerBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcPowerBtn.classList.add('active-btn');
                        inputVoltageGroup.classList.add('active');
                        inputCurrentGroup.classList.add('active');
                        break;
                    case 'voltage':
                        calcVoltageBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcVoltageBtn.classList.add('active-btn');
                        inputPowerGroup.classList.add('active');
                        inputCurrentGroup.classList.add('active');
                        break;
                    case 'current':
                        calcCurrentBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcCurrentBtn.classList.add('active-btn');
                        inputPowerGroup.classList.add('active');
                        inputVoltageGroup.classList.add('active');
                        break;
                    case 'torque':
                        calcTorqueBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcTorqueBtn.classList.add('active-btn');
                        inputPowerGroup.classList.add('active');
                        inputRpmGroup.classList.add('active');
                        break;
                    case 'trig':
                        calcTrigBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcTrigBtn.classList.add('active-btn');
                        inputTrigGroup.classList.add('active');
                        updateTrigButtonState();
                        break;
                    case 'area':
                        calcAreaBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcAreaBtn.classList.add('active-btn');
                        inputAreaGroup.classList.add('active');
                        updateAreaButtonState();
                        break;
                    case 'hypotenuse':
                        calcHypBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcHypBtn.classList.add('active-btn');
                        inputHypGroup.classList.add('active');
                        drawHypTriangle();
                        break;
                    case 'non-right-tri':
                        calcNonRightTriBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcNonRightTriBtn.classList.add('active-btn');
                        inputNonRightTriGroup.classList.add('active');
                        drawNonRightTri();
                        break;
                    case 'arcLength':
                        calcArcBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcArcBtn.classList.add('active-btn');
                        inputArcGroup.classList.add('active');
                        drawArc();
                        break;
                    case 'lineSpeed':
                        calcLineSpeedBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcLineSpeedBtn.classList.add('active-btn');
                        inputLineSpeedGroup.classList.add('active');
                        break;
                    case 'inverterHz':
                        calcInverterHzBtn.classList.remove('bg-gray-200', 'text-gray-700');
                        calcInverterHzBtn.classList.add('active-btn');
                        inputInverterHzGroup.classList.add('active');
                        break;
                }
                
                // Clear result message
                resultMessage.textContent = '';
            }

            // Update trig sub-button styles
            function updateTrigButtonState() {
                trigButtons.forEach(btn => {
                    btn.classList.remove('active-btn');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                if (trigFunction === 'sin') {
                    calcSinBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcSinBtn.classList.add('active-btn');
                } else if (trigFunction === 'cos') {
                    calcCosBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcCosBtn.classList.add('active-btn');
                } else if (trigFunction === 'tan') {
                    calcTanBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcTanBtn.classList.add('active-btn');
                }
            }

            // Update area sub-button styles and input fields
            function updateAreaButtonState() {
                areaButtons.forEach(btn => {
                    btn.classList.remove('active-btn');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                
                inputRectGroup.classList.add('hidden');
                inputTriGroup.classList.add('hidden');
                inputTrapGroup.classList.add('hidden');
                inputRhombusGroup.classList.add('hidden');

                if (areaType === 'rectangle') {
                    calcRectBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcRectBtn.classList.add('active-btn');
                    inputRectGroup.classList.remove('hidden');
                } else if (areaType === 'triangle') {
                    calcTriBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcTriBtn.classList.add('active-btn');
                    inputTriGroup.classList.remove('hidden');
                } else if (areaType === 'trapezoid') {
                    calcTrapBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcTrapBtn.classList.add('active-btn');
                    inputTrapGroup.classList.remove('hidden');
                } else if (areaType === 'rhombus') {
                    calcRhombusBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    calcRhombusBtn.classList.add('active-btn');
                    inputRhombusGroup.classList.remove('hidden');
                }
                drawAreaShape();
            }

            // Add click listeners to main buttons
            calcPowerBtn.addEventListener('click', () => { calculationType = 'power'; updateState(); });
            calcVoltageBtn.addEventListener('click', () => { calculationType = 'voltage'; updateState(); });
            calcCurrentBtn.addEventListener('click', () => { calculationType = 'current'; updateState(); });
            calcTorqueBtn.addEventListener('click', () => { calculationType = 'torque'; updateState(); });
            calcTrigBtn.addEventListener('click', () => { calculationType = 'trig'; updateState(); });
            calcAreaBtn.addEventListener('click', () => { calculationType = 'area'; updateState(); });
            calcHypBtn.addEventListener('click', () => { calculationType = 'hypotenuse'; updateState(); });
            calcNonRightTriBtn.addEventListener('click', () => { calculationType = 'non-right-tri'; updateState(); });
            calcArcBtn.addEventListener('click', () => { calculationType = 'arcLength'; updateState(); });
            calcLineSpeedBtn.addEventListener('click', () => { calculationType = 'lineSpeed'; updateState(); });
            calcInverterHzBtn.addEventListener('click', () => { calculationType = 'inverterHz'; updateState(); });

            // Add click listeners to trig sub-buttons
            calcSinBtn.addEventListener('click', () => { trigFunction = 'sin'; updateTrigButtonState(); });
            calcCosBtn.addEventListener('click', () => { trigFunction = 'cos'; updateTrigButtonState(); });
            calcTanBtn.addEventListener('click', () => { trigFunction = 'tan'; updateTrigButtonState(); });

            // Add click listeners to area sub-buttons
            calcRectBtn.addEventListener('click', () => { areaType = 'rectangle'; updateAreaButtonState(); });
            calcTriBtn.addEventListener('click', () => { areaType = 'triangle'; updateAreaButtonState(); });
            calcTrapBtn.addEventListener('click', () => { areaType = 'trapezoid'; updateAreaButtonState(); });
            calcRhombusBtn.addEventListener('click', () => { areaType = 'rhombus'; updateAreaButtonState(); });

            // Add input listeners for real-time drawing
            hypAInput.addEventListener('input', drawHypTriangle);
            hypBInput.addEventListener('input', drawHypTriangle);
            nonRightAInput.addEventListener('input', drawNonRightTri);
            nonRightBInput.addEventListener('input', drawNonRightTri);
            nonRightAngleInput.addEventListener('input', drawNonRightTri);
            rectLengthInput.addEventListener('input', drawAreaShape);
            rectWidthInput.addEventListener('input', drawAreaShape);
            triBaseInput.addEventListener('input', drawAreaShape);
            triHeightInput.addEventListener('input', drawAreaShape);
            trapBase1Input.addEventListener('input', drawAreaShape);
            trapBase2Input.addEventListener('input', drawAreaShape);
            trapHeightInput.addEventListener('input', drawAreaShape);
            rhombusDiag1Input.addEventListener('input', drawAreaShape);
            rhombusDiag2Input.addEventListener('input', drawAreaShape);
            radiusInput.addEventListener('input', drawArc);
            arcAngleInput.addEventListener('input', drawArc);

            // Initialize state
            updateState();

            // Add main calculate button click listener
            calculateBtn.addEventListener('click', () => {
                let result = null;
                let unit = '';
                let valid = true;
                
                // Clear result message and reset style
                resultMessage.textContent = '';
                resultMessage.className = 'mt-4 text-center text-xl font-bold text-gray-800';

                switch (calculationType) {
                    case 'power':
                        const voltage = parseFloat(voltageInput.value);
                        const current = parseFloat(currentInput.value);
                        if (isNaN(voltage) || isNaN(current) || voltage < 0 || current < 0) {
                            resultMessage.textContent = '請輸入有效的電壓和電流。';
                            valid = false;
                        } else {
                            result = voltage * current;
                            unit = '瓦特 (W)';
                        }
                        break;
                    case 'voltage':
                        const powerV = parseFloat(powerInput.value);
                        const currentV = parseFloat(currentInput.value);
                        if (isNaN(powerV) || isNaN(currentV) || powerV < 0 || currentV <= 0) {
                             resultMessage.textContent = '請輸入有效的功率和電流（電流不能為0）。';
                             valid = false;
                        } else {
                            result = powerV / currentV;
                            unit = '伏特 (V)';
                        }
                        break;
                    case 'current':
                        const powerI = parseFloat(powerInput.value);
                        const voltageI = parseFloat(voltageInput.value);
                        if (isNaN(powerI) || isNaN(voltageI) || powerI < 0 || voltageI <= 0) {
                             resultMessage.textContent = '請輸入有效的功率和電壓（電壓不能為0）。';
                             valid = false;
                        } else {
                            result = powerI / voltageI;
                            unit = '安培 (A)';
                        }
                        break;
                    case 'torque':
                        const powerT = parseFloat(powerInput.value);
                        const rpm = parseFloat(rpmInput.value);
                        if (isNaN(powerT) || isNaN(rpm) || powerT < 0 || rpm <= 0) {
                             resultMessage.textContent = '請輸入有效的功率和轉速（轉速不能為0）。';
                             valid = false;
                        } else {
                            const angularVelocity = (rpm * 2 * Math.PI) / 60;
                            result = powerT / angularVelocity;
                            unit = '牛頓·米 (Nm)';
                        }
                        break;
                    case 'trig':
                        const angle = parseFloat(angleInput.value);
                        if (isNaN(angle)) {
                            resultMessage.textContent = '請輸入有效的角度。';
                            valid = false;
                        } else {
                            const radians = angle * Math.PI / 180;
                            if (trigFunction === 'sin') {
                                result = Math.sin(radians);
                                unit = '';
                            } else if (trigFunction === 'cos') {
                                result = Math.cos(radians);
                                unit = '';
                            } else if (trigFunction === 'tan') {
                                if (Math.abs(Math.cos(radians)) < 1e-9) {
                                    resultMessage.textContent = 'tan值在該角度無定義。';
                                    valid = false;
                                } else {
                                    result = Math.tan(radians);
                                    unit = '';
                                }
                            }
                        }
                        break;
                    case 'area':
                        if (areaType === 'rectangle') {
                            const length = parseFloat(rectLengthInput.value);
                            const width = parseFloat(rectWidthInput.value);
                            if (isNaN(length) || isNaN(width) || length < 0 || width < 0) {
                                resultMessage.textContent = '請輸入有效的長度和寬度。';
                                valid = false;
                            } else {
                                result = length * width;
                            }
                        } else if (areaType === 'triangle') {
                            const base = parseFloat(triBaseInput.value);
                            const height = parseFloat(triHeightInput.value);
                            if (isNaN(base) || isNaN(height) || base < 0 || height < 0) {
                                resultMessage.textContent = '請輸入有效的底和高。';
                                valid = false;
                            } else {
                                result = 0.5 * base * height;
                            }
                        } else if (areaType === 'trapezoid') {
                            const base1 = parseFloat(trapBase1Input.value);
                            const base2 = parseFloat(trapBase2Input.value);
                            const height = parseFloat(trapHeightInput.value);
                            if (isNaN(base1) || isNaN(base2) || isNaN(height) || base1 < 0 || base2 < 0 || height < 0) {
                                resultMessage.textContent = '請輸入有效的上底、下底和高。';
                                valid = false;
                            } else {
                                result = 0.5 * (base1 + base2) * height;
                            }
                        } else if (areaType === 'rhombus') {
                            const diag1 = parseFloat(rhombusDiag1Input.value);
                            const diag2 = parseFloat(rhombusDiag2Input.value);
                            if (isNaN(diag1) || isNaN(diag2) || diag1 < 0 || diag2 < 0) {
                                resultMessage.textContent = '請輸入有效的對角線長度。';
                                valid = false;
                            } else {
                                result = 0.5 * diag1 * diag2;
                            }
                        }
                        unit = '平方毫米 ($mm^2$)';
                        if (valid) {
                            result = result.toFixed(1);
                        }
                        break;
                    case 'hypotenuse':
                        const a = parseFloat(hypAInput.value);
                        const b = parseFloat(hypBInput.value);
                        if (isNaN(a) || isNaN(b) || a < 0 || b < 0) {
                            resultMessage.textContent = '請輸入有效的直角邊長。';
                            valid = false;
                        } else {
                            result = Math.sqrt(a * a + b * b);
                            unit = 'mm';
                        }
                        break;
                    case 'non-right-tri':
                        const nonRightA = parseFloat(nonRightAInput.value);
                        const nonRightB = parseFloat(nonRightBInput.value);
                        const nonRightAngle = parseFloat(nonRightAngleInput.value);
                        if (isNaN(nonRightA) || isNaN(nonRightB) || isNaN(nonRightAngle) || nonRightA < 0 || nonRightB < 0 || nonRightAngle <= 0 || nonRightAngle >= 180) {
                            resultMessage.textContent = '請輸入有效的兩邊長和夾角（角度需介於0到180之間）。';
                            valid = false;
                        } else {
                            const angleRad = nonRightAngle * Math.PI / 180;
                            result = Math.sqrt(nonRightA * nonRightA + nonRightB * nonRightB - 2 * nonRightA * nonRightB * Math.cos(angleRad));
                            unit = 'mm';
                        }
                        break;
                    case 'arcLength':
                        const radius = parseFloat(radiusInput.value);
                        const arcAngle = parseFloat(arcAngleInput.value);
                        if (isNaN(radius) || isNaN(arcAngle) || radius < 0) {
                            resultMessage.textContent = '請輸入有效的半徑和角度。';
                            valid = false;
                        } else {
                            const arcRadians = arcAngle * Math.PI / 180;
                            result = radius * arcRadians;
                            unit = 'mm';
                        }
                        break;
                    case 'lineSpeed':
                        const circumference = parseFloat(circumferenceInput.value);
                        const lineSpeedRpm = parseFloat(lineSpeedRpmInput.value);
                        if (isNaN(circumference) || isNaN(lineSpeedRpm) || circumference < 0 || lineSpeedRpm < 0) {
                            resultMessage.textContent = '請輸入有效的作業長度和作業速度。';
                            valid = false;
                        } else {
                            // Convert circumference from mm to meters for a standard m/min calculation
                            const circumferenceMeters = circumference / 1000;
                            // Line speed = Circumference * RPM
                            result = circumferenceMeters * lineSpeedRpm;
                            unit = '米/每分鐘 (m/min)';
                        }
                        break;
                    case 'inverterHz':
                        const maxHz = parseFloat(maxHzInput.value);
                        const wheelCircumference = parseFloat(wheelCircumferenceInput.value);
                        const motorRpm = parseFloat(motorRpmInput.value);
                        const workingSpeed = parseFloat(workingSpeedInput.value);

                        if (isNaN(maxHz) || isNaN(wheelCircumference) || isNaN(motorRpm) || isNaN(workingSpeed) || maxHz <= 0 || wheelCircumference <= 0 || motorRpm <= 0 || workingSpeed < 0) {
                            resultMessage.textContent = '所有輸入值都必須為有效的正數（作業速度可為0）。';
                            valid = false;
                        } else {
                            // Calculate maximum possible output speed (mm/min)
                            const maxOutputSpeed = motorRpm * wheelCircumference;
                            // Calculate HZ based on the ratio of desired speed to max speed
                            if (maxOutputSpeed === 0) {
                                resultMessage.textContent = '馬達轉速或作業輪圓周不能為0。';
                                valid = false;
                            } else {
                                result = (workingSpeed / maxOutputSpeed) * maxHz;
                                unit = 'HZ';
                            }
                        }
                        break;
                }

                if (valid) {
                    // Display the result
                    resultMessage.textContent = `結果：${result.toFixed(2)} ${unit}`;
                    resultMessage.className = 'mt-4 text-center text-xl font-bold text-green-600';
                } else {
                     // Display the error message
                    resultMessage.className = 'mt-4 text-center text-xl font-bold text-red-600';
                }
            });
        });
    </script>
</body>
</html>